<style>
/* ===== TARJETA ===== */
.tarjeta{
  background:radial-gradient(circle at top,#020617,#000);
  color:white;
  padding:25px;
  border-radius:22px;
  font-family:'Segoe UI',Arial;
  box-shadow:0 0 60px rgba(56,189,248,.5);
  position:relative;
  overflow:hidden;
  transition: background 1s;
}

/* ===== TITULO ===== */
.titulo{
  text-align:center;
  font-size:1.6em;
  color:#38bdf8;
  margin-bottom:15px;
  letter-spacing:3px;
  text-shadow:0 0 25px #38bdf8;
}

/* ===== CONTENEDOR ===== */
.contenedor{
  display:flex;
  gap:20px;
  position:relative;
}

/* ===== PISTA ===== */
.pista{
  position:relative;
  height:160px;
  flex:1;
  background:#020617;
  border-radius:18px;
  overflow:hidden;
  border:2px solid #1e293b;
  box-shadow: inset 0 0 50px rgba(56,189,248,.45),0 0 40px rgba(56,189,248,.6);
  transition: box-shadow 0.5s, background 1s;
}

/* ===== ILUMINACION CAMINO POR SEMAFORO ===== */
.pista.rojo{box-shadow: inset 0 0 60px rgba(239,68,68,.6),0 0 50px rgba(239,68,68,.8);}
.pista.amarillo{box-shadow: inset 0 0 60px rgba(250,204,21,.6),0 0 50px rgba(250,204,21,.8);}
.pista.verde{box-shadow: inset 0 0 60px rgba(34,197,94,.6),0 0 50px rgba(34,197,94,.8);}

/* ===== BARRERA ZEBRA (AMARILLO/NEGRO) ===== */
.pared{
  position:absolute;
  left:10px;
  top:10px;
  width:20px;
  height:130px;
  background:repeating-linear-gradient(
    45deg,
    #facc15 0 10px,
    #000 10px 20px
  );
  border-radius:6px;
  box-shadow:0 0 35px yellow;
  z-index:2;
}

/* ===== LLUVIA ===== */
.lluvia{
  position:absolute;
  inset:0;
  background:repeating-linear-gradient(
    120deg,
    rgba(255,255,255,.35) 0px,
    rgba(255,255,255,.35) 2px,
    transparent 2px,
    transparent 12px
  );
  animation: lluvia 0.35s linear infinite;
  opacity:.5;
  display:block;
  z-index:1;
}

@keyframes lluvia{
  from{background-position:0 0}
  to{background-position:-50px 100px}
}

/* ===== AUTO ===== */
.auto{
  position:absolute;
  top:45px;
  font-size:64px;
  transition:left .25s ease-out;
  filter:drop-shadow(0 0 25px cyan) drop-shadow(0 0 20px #fff);
  z-index:3;
}

/* ===== NEBLINEROS ===== */
.luces{
  position:absolute;
  top:58px;
  width:40px;
  height:16px;
  left:-30px;
  background:linear-gradient(to left, rgba(255,255,200,.7), transparent);
  filter:blur(8px);
  border-radius:6px;
}

/* ===== VIBRACION ===== */
@keyframes vibrar{
  0%{transform:translate(0)}
  25%{transform:translate(2px,-2px)}
  50%{transform:translate(-2px,2px)}
  75%{transform:translate(2px,2px)}
  100%{transform:translate(0)}
}

.peligro .auto{
  animation:vibrar .15s infinite;
}

/* ===== SEMAFORO ===== */
.semaforo{
  width:70px;
  background:#020617;
  border-radius:16px;
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:10px;
  box-shadow:0 0 30px #000;
}

.luz{
  width:42px;
  height:42px;
  border-radius:50%;
  opacity:.15;
}

.rojo{background:#ef4444}
.amarillo{background:#facc15}
.verde{background:#22c55e}

.peligro .rojo{opacity:1;box-shadow:0 0 40px red}
.alerta .amarillo{opacity:1;box-shadow:0 0 40px yellow}
.seguro .verde{opacity:1;box-shadow:0 0 40px #22c55e}

/* ===== INFO ===== */
.info{
  text-align:center;
  margin-top:20px;
}

.distancia{
  font-size:2.7em;
  font-weight:bold;
}

.estado{
  font-size:1.3em;
  letter-spacing:4px;
}

/* ===== SOL ===== */
.sol{
  position:absolute;
  top:10px;
  right:20px;
  font-size:48px;
  color:yellow;
  filter:drop-shadow(0 0 40px yellow);
  display:none;
  z-index:1;
}
</style>

<div class="tarjeta"
ng-class="{
  'peligro': value <= 10,
  'alerta': value > 10 && value <= 20,
  'seguro': value > 20
}">

  <div class="titulo">SENSOR DE PROXIMIDAD</div>

  <div class="contenedor">

    <!-- PISTA -->
    <div class="pista" id="pista">
      <div class="lluvia" id="lluvia"></div>
      <div class="pared"></div>

      <div class="auto"
        ng-style="{ left:(value>170?170:value)+'px' }">
        üöó
        <div class="luces"></div>
      </div>

      <div class="sol" id="sol">‚òÄÔ∏è</div>
    </div>

    <!-- SEMAFORO -->
    <div class="semaforo">
      <div class="luz rojo"></div>
      <div class="luz amarillo"></div>
      <div class="luz verde"></div>
    </div>

  </div>

  <div class="info">
    <div class="distancia">{{value | number:1}} cm</div>
    <div class="estado">
      {{ value<=10?'PELIGRO':(value<=20?'ALERTA':'SEGURO') }}
    </div>
  </div>

</div>

<script>
/* ===== CICLO LLUVIA / DESPEJADO CON SOL ===== */
let ll = document.getElementById('lluvia');
let sol = document.getElementById('sol');
let tarjeta = document.querySelector('.tarjeta');
let pista = document.getElementById('pista');
let lluvia=true;

function actualizarPistaPorSemaforo(val){
  pista.classList.remove('rojo','amarillo','verde');
  if(val<=10) pista.classList.add('rojo');
  else if(val<=20) pista.classList.add('amarillo');
  else pista.classList.add('verde');
}

setInterval(()=>{
  lluvia=!lluvia;
  if(lluvia){
    ll.style.display='block';
    sol.style.display='none';
    tarjeta.style.background='radial-gradient(circle at top,#020617,#000)';
  }else{
    ll.style.display='none';
    sol.style.display='block';
    tarjeta.style.background='radial-gradient(circle at top,#ffd95b,#facc15)';
  }
},5000);

/* ===== OBSERVAR CAMBIO DE DISTANCIA PARA SEMAFORO ===== */
let observer = new MutationObserver(()=>{
  let val = parseFloat(document.querySelector('.distancia').innerText);
  actualizarPistaPorSemaforo(val);
});
observer.observe(document.querySelector('.distancia'),{characterData:true,subtree:true,childList:true});
</script>




